<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin - Nutrition Scanner</title>
<style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 10px; background: #f0f2f5; }
    h1 { text-align: center; }
    #login-container, #admin-container { max-width: 800px; margin: auto; }
    #login-container { display: flex; flex-direction: column; align-items: center; }
    #login-container input { margin: 5px; padding: 10px; font-size: 1em; }
    #product-grid { display: grid; grid-template-columns: repeat(auto-fill,minmax(250px,1fr)); gap: 15px; margin-top: 20px; }
    .product-card { background: white; border-radius: 10px; padding: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.2); }
    .product-card input { width: 100%; margin: 5px 0; padding: 5px; box-sizing: border-box; }
    button { padding: 8px 12px; margin: 5px 0; cursor: pointer; border: none; border-radius: 5px; }
    #add-product { background: #28a745; color: white; }
    #export-json { background: #007bff; color: white; width: 100%; }
</style>
</head>
<body>

<h1>Admin - Nutrition Scanner</h1>

<div id="login-container">
    <input type="password" id="password" placeholder="Enter Admin Password" />
    <button id="login-btn">Login</button>
</div>

<div id="admin-container" style="display:none;">
    <button id="add-product">+ Add Product</button>
    <div id="product-grid"></div>
    <button id="export-json">Export JSON</button>
    <textarea id="json-output" style="width:100%; height:150px; margin-top:10px;"></textarea>
</div>

<script>
const ADMIN_PASSWORD = "admin123"; // Change this to your password
const loginContainer = document.getElementById('login-container');
const adminContainer = document.getElementById('admin-container');
const loginBtn = document.getElementById('login-btn');
const passwordInput = document.getElementById('password');
const productGrid = document.getElementById('product-grid');
const addBtn = document.getElementById('add-product');
const exportBtn = document.getElementById('export-json');
const jsonOutput = document.getElementById('json-output');

let products = {
    "0123456789012": {
        name: "Chocolate Bar",
        serving: "1 bar (50g)",
        calories: 250,
        fat: "12g",
        carbs: "30g",
        protein: "3g",
        grade: 70
    },
    "9876543210987": {
        name: "Granola Bar",
        serving: "1 bar (40g)",
        calories: 180,
        fat: "6g",
        carbs: "28g",
        protein: "5g",
        grade: 85
    }
};

function renderGrid() {
    productGrid.innerHTML = "";
    Object.keys(products).forEach(barcode => {
        const p = products[barcode];
        const card = document.createElement('div');
        card.className = 'product-card';
        card.innerHTML = `
            <label>Barcode</label><input type="text" value="${barcode}" class="barcode">
            <label>Name</label><input type="text" value="${p.name}" class="name">
            <label>Serving</label><input type="text" value="${p.serving}" class="serving">
            <label>Calories</label><input type="number" value="${p.calories}" class="calories">
            <label>Fat</label><input type="text" value="${p.fat}" class="fat">
            <label>Carbs</label><input type="text" value="${p.carbs}" class="carbs">
            <label>Protein</label><input type="text" value="${p.protein}" class="protein">
            <label>Grade</label><input type="number" value="${p.grade}" class="grade">
            <button class="delete-btn" style="background:#dc3545;color:white;">Delete</button>
        `;
        productGrid.appendChild(card);

        card.querySelector('.delete-btn').addEventListener('click', () => {
            delete products[barcode];
            renderGrid();
        });

        const inputs = card.querySelectorAll('input');
        inputs.forEach(input => {
            input.addEventListener('change', () => {
                const newBarcode = card.querySelector('.barcode').value;
                products[newBarcode] = {
                    name: card.querySelector('.name').value,
                    serving: card.querySelector('.serving').value,
                    calories: parseInt(card.querySelector('.calories').value),
                    fat: card.querySelector('.fat').value,
                    carbs: card.querySelector('.carbs').value,
                    protein: card.querySelector('.protein').value,
                    grade: parseInt(card.querySelector('.grade').value)
                };
                if (newBarcode !== barcode) {
                    delete products[barcode];
                    renderGrid();
                }
            });
        });
    });
}

loginBtn.addEventListener('click', () => {
    if(passwordInput.value === ADMIN_PASSWORD){
        loginContainer.style.display = 'none';
        adminContainer.style.display = 'block';
        renderGrid();
    } else {
        alert('Incorrect password!');
    }
});

addBtn.addEventListener('click', () => {
    const newBarcode = Date.now().toString().slice(-12);
    products[newBarcode] = { name:"New Product", serving:"1 unit", calories:0, fat:"0g", carbs:"0g", protein:"0g", grade:0 };
    renderGrid();
});

exportBtn.addEventListener('click', () => {
    jsonOutput.value = JSON.stringify(products, null, 2);
});
</script>

</body>
</html>
