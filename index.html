<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Barcode Scanner</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; background: #f0f0f0; }
  #product { display: none; padding: 20px; border-radius: 10px; background: white; width: 90%; max-width: 400px; margin: 20px auto; box-shadow: 0 2px 10px rgba(0,0,0,0.2); }
  #product div { margin-bottom: 10px; }
  .grade { padding: 5px 10px; color: white; border-radius: 5px; font-weight: bold; display: inline-block; }
  video { width: 100%; max-width: 400px; border-radius: 10px; }
</style>
</head>
<body>

<h1>Scan a Product</h1>
<video id="video" autoplay></video>

<div id="product">
  <div id="name"></div>
  <div id="calories"></div>
  <div id="serving"></div>
  <div id="nutrition"></div>
  <div id="grade" class="grade"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@zxing/library@latest"></script>
<script>
const video = document.getElementById('video');
const productDiv = document.getElementById('product');
const nameDiv = document.getElementById('name');
const caloriesDiv = document.getElementById('calories');
const servingDiv = document.getElementById('serving');
const nutritionDiv = document.getElementById('nutrition');
const gradeDiv = document.getElementById('grade');

let products = [
  {
    barcode: "123456789012",
    name: "Apple",
    calories: 95,
    serving: "1 medium",
    grade: 90,
    nutrition: { protein: 0.5, fat: 0.3, carbs: 25, sugar: 19, fiber: 4.4, sodium: 1 }
  },
  {
    barcode: "987654321098",
    name: "Chocolate Bar",
    calories: 250,
    serving: "1 bar",
    grade: 45,
    nutrition: { protein: 3, fat: 13, carbs: 30, sugar: 25, fiber: 2, sodium: 50 }
  }
];

function showProduct(product) {
  nameDiv.textContent = product.name;
  caloriesDiv.textContent = `Calories: ${product.calories}`;
  servingDiv.textContent = `Serving: ${product.serving}`;
  const n = product.nutrition;
  nutritionDiv.innerHTML = `
    Protein: ${n.protein}g<br>
    Fat: ${n.fat}g<br>
    Carbs: ${n.carbs}g<br>
    Sugar: ${n.sugar}g<br>
    Fiber: ${n.fiber}g<br>
    Sodium: ${n.sodium}mg
  `;
  gradeDiv.textContent = `Grade: ${product.grade}/100`;
  gradeDiv.style.backgroundColor = product.grade >= 75 ? 'green' : product.grade >= 40 ? 'yellow' : 'red';
  productDiv.style.display = 'block';
}

// Setup webcam scanning
const codeReader = new ZXing.BrowserBarcodeReader();
codeReader.decodeFromVideoDevice(null, video, (result, err) => {
  if (result) {
    const product = products.find(p => p.barcode === result.text);
    if (product) showProduct(product);
  }
});
</script>
</body>
</html>
